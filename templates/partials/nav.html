    <!-- Navigation -->
    <nav class="navbar">
    <style>
        .navbar .nav-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-width: none;
            margin: 0;
            align-items: stretch;
        }
        .nav-row-apps {
            display: flex;
            justify-content: flex-start;
            flex-wrap: wrap;
            gap: 4px 16px;
        }
        .nav-row-apps a {
            color: #6b7280;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.875em;
        }
        .nav-row-apps a:hover {
            color: #111827;
            text-decoration: none;
        }
        .nav-row-apps a.current {
            color: #111827;
        }
        .nav-row-brand {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .nav-row-brand .brand-logo {
            color: #2B7BD3;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.15em;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            letter-spacing: -0.02em;
        }
        .nav-row-brand .brand-logo:hover {
            color: #1a5ca8;
        }
        .language-selector {
            position: relative;
        }
        .language-current {
            display: flex;
            align-items: center;
            gap: 6px;
            background: transparent;
            padding: 6px 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8em;
            font-weight: 500;
            color: #6b7280;
            transition: color 0.15s;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            border: 1px solid #e5e7eb;
        }
        .language-current:hover {
            color: #111827;
            border-color: #9ca3af;
        }
        .language-current .flag {
            font-size: 1.1em;
        }
        .language-current .arrow {
            font-size: 0.6em;
            transition: transform 0.2s;
        }
        .language-selector.open .arrow {
            transform: rotate(180deg);
        }
        .language-dropdown {
            position: absolute;
            top: calc(100% + 6px);
            right: 0;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
            border: 1px solid #f3f4f6;
            overflow: hidden;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-4px);
            transition: opacity 0.15s, transform 0.15s, visibility 0.15s;
            min-width: 130px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
        }
        .language-selector.open .language-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        .language-dropdown a {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            text-decoration: none;
            color: #333;
            font-size: 0.85em;
            transition: background 0.2s;
        }
        .language-dropdown a:hover,
        .language-dropdown a:active {
            background: #f5f5f5;
        }
        .language-dropdown a.active {
            background: #e8f0fe;
            color: #2B7BD3;
            font-weight: 600;
        }
        .language-dropdown a .flag {
            font-size: 1em;
        }
        @media (max-width: 768px) {
            .nav-row-apps a {
                font-size: 0.85em;
            }
        }
        @media (prefers-color-scheme: dark) {
            .nav-row-apps a {
                color: #6b7280;
            }
            .nav-row-apps a:hover {
                color: #e5e7eb;
            }
            .nav-row-apps a.current {
                color: #e5e7eb;
            }
            .nav-row-brand .brand-logo {
                color: #60a5fa;
            }
            .nav-row-brand .brand-logo:hover {
                color: #93bbfd;
            }
            .language-current {
                background: transparent;
                color: #6b7280;
                border-color: #1f2937;
            }
            .language-current:hover {
                color: #e5e7eb;
                border-color: #374151;
            }
            .language-dropdown {
                background: #111827;
                border-color: #1f2937;
                box-shadow: 0 4px 24px rgba(0, 0, 0, 0.3);
            }
            .language-dropdown a {
                color: #9ca3af;
            }
            .language-dropdown a:hover,
            .language-dropdown a:active {
                background: #1f2937;
                color: #e5e7eb;
            }
            .language-dropdown a.active {
                background: #1f2937;
                color: #60a5fa;
            }
        }
    </style>
    <div class="nav-container">
        <div class="nav-row-brand">
            <a href="{{brandUrl}}" class="brand-logo">feeltracker</a>
            <div class="language-selector" id="langSelector">
                <div class="language-current" onclick="document.getElementById('langSelector').classList.toggle('open')">
                    <span class="flag">{{lang.flag}}</span>
                    <span>{{lang.name}}</span>
                    <span class="arrow">â–¼</span>
                </div>
                <div class="language-dropdown">
{{#each langSwitcher}}
                    <a href="{{url}}"{{#if isCurrent}} class="active"{{/if}}><span class="flag">{{flag}}</span> {{name}}</a>
{{/each}}
                </div>
            </div>
        </div>
        <div class="nav-row-apps">
{{#each navApps}}
            <a href="{{url}}"{{#if isCurrent}} class="current"{{/if}}>{{name}}</a>
{{/each}}
        </div>
    </div>
    <script>
    document.addEventListener('click', function(e) {
        var selector = document.getElementById('langSelector');
        if (selector && !selector.contains(e.target)) {
            selector.classList.remove('open');
        }
    });
    </script>
</nav>
